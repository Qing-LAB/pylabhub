# cmake/CleanPrereqResidue.cmake
# Generated by configure_file() â€” do not edit directly.
# Removes autotools and build-system residue files from a directory before staging.
#
# Variables (substituted at configure time):
#   CLEAN_DIR: The root directory to clean (e.g., PREREQ_INSTALL_DIR).

set(CLEAN_DIR "@CLEAN_DIR@")
file(TO_CMAKE_PATH "${CLEAN_DIR}" CLEAN_DIR)

if(NOT EXISTS "${CLEAN_DIR}")
  message(STATUS "[pylabhub-clean] Directory does not exist: ${CLEAN_DIR}")
  return()
endif()

# Exact filenames to remove (autotools/build residue)
set(_exact_names
  "Makefile.in"
  "Makefile.am"
  "configure"
  "configure.ac"
  "aclocal.m4"
  "install-sh"
  "missing"
  "depcomp"
  "ltmain.sh"
  "config.guess"
  "config.sub"
  "stamp-h1"
)

# Remove .deps directories recursively
file(GLOB_RECURSE _deps_dirs "${CLEAN_DIR}/.deps")
foreach(_d IN LISTS _deps_dirs)
  if(IS_DIRECTORY "${_d}")
    file(REMOVE_RECURSE "${_d}")
    message(STATUS "[pylabhub-clean] Removed dir: ${_d}")
  endif()
endforeach()

# Recurse through all files and remove matches
file(GLOB_RECURSE _all_files "${CLEAN_DIR}/*")
foreach(_path IN LISTS _all_files)
  if(IS_DIRECTORY "${_path}")
    continue()
  endif()
  get_filename_component(_name "${_path}" NAME)
  # Check exact names
  foreach(_exact IN LISTS _exact_names)
    if(_name STREQUAL "${_exact}")
      file(REMOVE "${_path}")
      message(STATUS "[pylabhub-clean] Removed: ${_path}")
      break()
    endif()
  endforeach()
  # Check config.h.in (path may vary)
  if(_name STREQUAL "config.h.in")
    file(REMOVE "${_path}")
    message(STATUS "[pylabhub-clean] Removed: ${_path}")
  endif()
  # Check *.in suffix (template files, but not version.h.in if it gets processed - be careful)
  # version.h.in is typically processed to version.h; the .in may remain in source
  if(_name MATCHES "\\.in$")
    file(REMOVE "${_path}")
    message(STATUS "[pylabhub-clean] Removed: ${_path}")
  endif()
endforeach()

message(STATUS "[pylabhub-clean] Prereq residue cleanup complete for ${CLEAN_DIR}")
